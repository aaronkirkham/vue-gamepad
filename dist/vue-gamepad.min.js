!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueGamepad=t()}(this,function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=["button-a","button-b","button-x","button-y","shoulder-left","shoulder-right","trigger-left","trigger-right","button-select","button-start","left-stick-in","right-stick-in","button-dpad-up","button-dpad-down","button-dpad-left","button-dpad-right","vendor"],n=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.pressed=new Set,this.events={},this.layer=0,this.layers={},window.addEventListener("gamepadconnected",this.padConnected.bind(this)),window.addEventListener("gamepaddisconnected",this.padDisconnected.bind(this)),this.animationFrame=requestAnimationFrame(this.run.bind(this))}var e,t,a;return e=n,(t=[{key:"padConnected",value:function(e){document.body.classList.add("gamepad-connected")}},{key:"padDisconnected",value:function(e){0===this.getGamepads().length&&document.body.classList.remove("gamepad-connected")}},{key:"addListener",value:function(e,t,n){var a=this,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;console.log("listening for '".concat(t,"' on layer ").concat(this.layer,"...")),void 0===this.events[this.layer]&&(this.events[this.layer]={},o.forEach(function(e){return a.events[a.layer][e]=[]})),this.events[this.layer][t].push({vnode:i,callback:n}),console.log(this.events[this.layer][t])}},{key:"removeListener",value:function(e,t){console.log("removing listener for '".concat(e,"' on layer ").concat(this.layer,"..."));var n=this.events[this.layer];n[e]=n[e].filter(function(e){return e.callback!==t})}},{key:"switchToLayer",value:function(e){this.layer!=e&&(this.layers[e]=this.layer,this.layer=e,console.log("switched to layer ".concat(this.layer,".")))}},{key:"removeLayer",value:function(e){this.layer=this.layers[e],delete this.layers[e],delete this.events[e],console.log("switched back to layer ".concat(this.layer,"."))}},{key:"run",value:function(){var i=this;this.getGamepads().forEach(function(e){e.buttons.forEach(function(e,t){var n=o[t],a=i.events[i.layer][n];if(e.pressed&&!i.pressed.has(n))i.pressed.add(n),a.length;else if(!e.pressed&&i.pressed.has(n)){if(i.pressed.delete(n),0<a.length)a[a.length-1].callback.call()}})}),this.animationFrame=requestAnimationFrame(this.run.bind(this))}},{key:"getGamepads",value:function(){return Array.from(navigator.getGamepads()).filter(function(e){return null!==e})}}])&&i(e.prototype,t),a&&i(e,a),n}(),s=function(e){return e.arg&&o.includes(e.arg)&&("function"==typeof e.value||void 0===e.value&&void 0===e.expression)};return{install:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=new n(e,t);console.log(r),e.prototype.$gamepad=r,e.directive("gamepad",{bind:function(e,t,n){if(s(t)){var a=t.modifiers.pressed?"pressed":"released",i=t.arg,o=void 0!==t.value?t.value:n.data.on.click;r.addListener(a,i,o,n)}else console.error("vue-gamepad: invalid binding. '".concat(t.arg,"' was not bound."))},unbind:function(e,t,n){if(s(t)){var a=void 0!==t.value?t.value:n.data.on.click;r.removeListener(t.arg,a)}else console.error("vue-gamepad: invalid binding. '".concat(t.arg,"' was not unbound."))}}),e.directive("gamepad-layer",{bind:function(e,t,n){r.switchToLayer(t.value)},unbind:function(e,t){r.removeLayer(t.value)}})}}});
//# sourceMappingURL=vue-gamepad.min.js.map